@page "/bataillenavale"
@inject BateauService BateauService

<button @onclick="DemarrerPartie">Démarrer Partie</button>

@if (grille != null)
{
    <div class="grille">
        @for (int i = 0; i < 10; i++)
        {
            <div class="ligne">
                @for (int j = 0; j < 10; j++)
                {
                    <div class="case @(grille[i, j])">@grille[i, j]</div>
                }
            </div>
        }
    </div>
}

@code {
    private string[,] grille = new string[10, 10];

    private async Task DemarrerPartie()
    {
        var positionsBateaux = await BateauService.DemanderPositionsBateauxAsync();
        InitialiserGrille(positionsBateaux);
    }

    private void InitialiserGrille(List<BateauPosition> positionsBateaux)
    {
        // Remplir la grille avec des espaces vides
        for (int i = 0; i < 10; i++)
        {
            for (int j = 0; j < 10; j++)
            {
                grille[i, j] = " ";
            }
        }

        // Placer les bateaux sur la grille
        foreach (var bateau in positionsBateaux)
        {
            foreach (var position in bateau.PositionsBateaux)
            {
                foreach (var key in position.Keys)
                {
                    foreach (var coord in position[key])
                    {
                        var row = coord[0] - 'a'; // Convertit 'a' à '0'
                        var col = int.Parse(coord[1].ToString()) - 1; // Convertit 1-10 à 0-9
                        grille[row, col] = key; // Placer le bateau
                    }
                }
            }
        }
    }
}
